<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" type="text/css" href="/style/less.css" />
    <style type="text/css">
        body {background: #ccc; padding:50px; color: #222; font-size: 11pt; overflow: auto;}
        pre, form {width: 600px; margin-bottom: 1em;}

        form label {display: block; margin-top:1em;}
        input, textarea, select {font-size: 100%}
        input {width: 100%}
        textarea {min-width: 100%; min-height: 10em;}
        fieldset {margin-bottom: 1em;}
        button {background: #2048ff !important; color: white; border:0; border-radius: 3px; padding: 5px 20px;}
        pre {max-height: 20em; overflow: auto;}
        pre#errorspre {color: #c00;}
    </style>
    <script type="text/javascript" src="/node_modules/jquery/dist/jquery.min.js"></script>
    <script type="text/javascript">
        var con = new function() {
            var that = this;
            var $statusCode, $statusText, $responsePre, $errorsPre;

            this.sendRequest = function(method, path, data, clientId, clientSecret, settings) {
                var s = settings || {};
                s.dataType = 'json';
                s.data = data;
                if (typeof s.headers === 'undefined') s.headers = {};
                s.headers['x-vizor-clientid'] = clientId;
                s.headers['x-vizor-clientsecret'] = clientSecret;
                s.headers['Accept'] = "application/json; charset=utf-8";
                s.headers['Content-Type'] = "text/plain; charset=utf-8";
                s.url = path;
                s.method = method;
                s.type = method; // pre-1.9
                s.success = that.onSuccess;
                s.error = that.onError;
                var req = jQuery.ajax(s);
                return req;
            };

            this.onSuccess = function(data, textStatus, xhr) {
                if (typeof data === 'object') data = JSON.stringify(data, null, '  ');
                $responsePre.html(data);
                $errorsPre.html(' ');
                $statusText.html(textStatus);
                $statusCode.html(xhr.status);
                return true;
            };

            this.onError = function(xhr, textStatus, errorText) {
                $statusText.html(textStatus + ' ('+errorText+')');
                $statusCode.html(xhr.status);
                $errorsPre.html(xhr.responseText);
                $responsePre.html(' ');
                return true;
            };

            this.sendform = function(e) {
                e.preventDefault();
                var f = e.currentTarget, $form = jQuery(f);
                var path = jQuery('#request_path', $form).val().trim();
                var method = jQuery('#request_method', $form).val();
                var clientId = jQuery('#client_id', $form).val();
                var clientSecret = jQuery('#client_secret', $form).val();
                var data = jQuery('#request_body', $form).val();

                if (!path) return false;

                that.sendRequest(method, path, data, clientId, clientSecret);
                return false;
            };
            this.init = function() {
                jQuery('#theform').on('submit', that.sendform);
                $statusCode = jQuery('span#statuscode');
                $statusText = jQuery('span#statustext');
                $responsePre = jQuery('pre#responsepre');
                $errorsPre = jQuery('pre#errorspre');
            };
        };
        window.addEventListener('DOMContentLoaded', con.init);
    </script>
</head>
<body>
    <h3>Request</h3>
    <form id="theform">
        <fieldset>
        <div class="twocol clearfix">
            <div class="col">
                <label for="client_id">Client ID</label>
                <input type="text" name="client_id" id="client_id" value="Vv000CL1D" />
            </div>
            <div class="col">
                <label for="client_secret">Client Secret</label>
                <input type="text" name="client_secret" id="client_secret" value="0123456789" />
            </div>
        </div>



        <label for="request_path">Request path</label>
            <div class="twocol clearfix">
                <div class="col" style="width:10%">
                     <select name="request_method" id="request_method">
                        <option value="GET">GET</option>
                        <option value="POST">POST</option>
                        <option value="PUT">PUT</option>
                        <option value="DELETE">DELETE</option>
                    </select>
                </div>
                <div class="col" style="width:85%">
                    <input type="text" name="request_path" id="request_path" value="/account" />
                </div>
            </div>

        <label for="request_body">Request body</label>
        <textarea name="request_body" id="request_body"></textarea>
        </fieldset>
        <div style="text-align: right">
            <button id="sendbutton" type="submit">Send request</button>
        </div>
    </form>

    <h4>Response status:
        <span id="statuscode"></span> <span id="statustext">&nbsp;</span>
    </h4>

    <h3>Response</h3>
    <pre id="responsepre">

    </pre>

    <h3>Errors</h3>
    <pre id="errorspre">

    </pre>
</body>
</html>